define("backgroundCommon",["lodash","coreUtils","santa-components","componentsCore","prop-types","skins","warmupUtils","image-client-api","color","pmrpc"],function(e,t,i,a,n,o,r,s,d,p){return function(e){var t={};function i(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=402)}({0:function(t,i){t.exports=e},1:function(e,i){e.exports=t},172:function(e,t,i){var a,n;a=[i(0),i(4),i(3),i(9),i(22),i(2)],void 0===(n=function(e,t,i,a,n,o){"use strict";var r=o.components.imageCommon.imageElements;return{displayName:"bgImage",mixins:[i.mixins.skinBasedComp],propTypes:{cssFiltersSupported:o.santaTypesDefinitions.BrowserFlags.cssFiltersSupported.isRequired,compData:t.object.isRequired,shouldRenderSrc:t.bool,imageUrlPreMeasureParams:t.object,currentUrl:o.santaTypesDefinitions.currentUrl,getMediaFullStaticUrl:o.santaTypesDefinitions.ServiceTopology.getMediaFullStaticUrl.isRequired,filterEffect:t.object,style:t.object,mediaDimensions:t.object,imageData:t.object,fittingType:t.string,alignType:t.string,"data-type":t.string},extendWithFilterData:function(t){var i=void 0,a=void 0,n=r.getValidFilterName(this.props.filterEffect);n&&(i=this.props.id+"_"+n,a=r.getFilterComponent(i,n,e.omit(this.props.filterEffect,"effectType")),this.props.cssFiltersSupported&&(t[""].addChildren=a,e.assign(t.style,r.getCssStyleForFilterUse(i))))},getImageTransform:function(){var t=this.props,i=t.imageData,o=t.getMediaFullStaticUrl,r=t.currentUrl,s=t.mediaDimensions,d=e.pick(this.props.imageUrlPreMeasureParams,["width","height","filters","fittingType","imageCss"]),p={imageData:i,containerWidth:e.defaultTo(d.width,s.width),containerHeight:e.defaultTo(d.height,s.height),displayMode:e.defaultTo(d.fittingType,n.fittingTypes.TILE),quality:{quality:85},filters:d.filters};return a.imageUtils.getImageComputedProperties(n,p,o,r,1,"bg")},getSkinProperties:function(){var t={position:"absolute",width:"100%",height:"100%"};if(e.isNumber(this.props.compData.opacity)&&(t.opacity=this.props.compData.opacity),this.props.shouldRenderSrc){var i=this.getImageTransform();t.backgroundImage="url("+i.uri+")",t.height=this.props.style.height,e.assign(t,i.css.container)}var a=e.pick(this.props.imageData,["width","height","uri","name"]),n=e.pick(this.props,["alignType","fittingType"]);n.imageData=a;var o={"":{style:t,"data-tiled-image-info":JSON.stringify(n)}};return this.extendWithFilterData(o),o}}}.apply(t,a))||(e.exports=n)},173:function(e,t,i){var a,n;a=[i(0),i(4),i(3),i(1),i(2),i(174)],void 0===(n=function(e,t,i,a,n,o){"use strict";var r=a.mediaConsts;function s(t){return e.includes(t,"video")}function d(t){if(!s(t.videoRenderParts))return{"data-is-video-data-exists":""};var i=e.reject(t.compData.qualities,{quality:"storyboard"}),a=i.map(function(e){return{quality:e.quality,size:e.width*e.height}}),n=e.last(i);return{"data-player-type":"html5","data-is-video-data-exists":"1","data-video-width":n.width,"data-video-height":n.height,"data-qualities":JSON.stringify(a),"data-video-format":t.format}}return{displayName:"html5Video",mixins:[o,i.mixins.skinBasedComp,i.mixins.createChildComponentMixin],propTypes:e.defaults({compData:t.object.isRequired,compProp:t.object,parentId:t.string.isRequired,playFullscreen:t.bool,videoRenderParts:t.array,format:t.string,config:t.object,playbackUrl:t.string,mediaQuality:t.string,notifyMediaState:t.func.isRequired,notifyVideoVisibility:t.func.isRequired,showMedia:t.bool.isRequired,shouldRenderSrc:t.bool,posterWidth:t.number,posterHeight:t.number,setMediaAPI:t.func.isRequired,registerMediaSource:t.func,keepVideoHidden:t.bool,hasBgScrollEffect:t.bool,fittingType:t.string,alignType:t.string,isExperimentOpen:n.santaTypesDefinitions.isExperimentOpen.isRequired,staticVideoUrl:n.santaTypesDefinitions.ServiceTopology.staticVideoUrl,adaptiveVideoDomain:n.santaTypesDefinitions.ServiceTopology.adaptiveVideoDomain},n.utils.santaTypesUtils.getSantaTypesFromPropTypes(n.components.Image.propTypes)),getInitialState:function(){this.playWhenReady=!1,this.hls=null},componentDidMount:function(){this.refs.video.addEventListener("timeupdate",this.handlePosterVisibilityOnce),this.refs.video.addEventListener("volumechange",this.onVolumeChange),this.props.notifyMediaState({type:r.eventTypes.MOUNT,playbackState:r.playbackTypes.LOADING}),s(this.props.videoRenderParts)&&(this.initAdaptive(),this.setRate(this.props.compData.playbackSpeed||1)),this.props.setMediaAPI(this.mediaAPI),this.props.registerMediaSource&&this.props.registerMediaSource(this.refs.video)},componentDidLayout:function(){this.loadSource()},componentDidUpdate:function(){s(this.props.videoRenderParts)&&(this.initAdaptive(),this.setRate(this.props.compData.playbackSpeed||1),this.props.notifyMediaState({type:r.eventTypes.LOAD,looped:this.props.compProp.loop}))},componentWillUnmount:function(){this.props.setMediaAPI(null),this.props.notifyVideoVisibility(!1),s(this.props.videoRenderParts)&&(this.refs.video.removeEventListener("timeupdate",this.handlePosterVisibilityOnce),this.removeVideoSecurely())},loadSource:function(){var t=this.getUrl(),i=e.get(this.hls,"url",this.refs.video.currentSrc);t&&i!==t&&("hls"===this.props.format&&this.hls?this.hls.loadSource(t):(this.refs.video.src=t,this.refs.video.load()))},getUrl:function(){var t=this.props.compData,i=this.refs.video.getAttribute("data-quality");if(s(this.props.videoRenderParts)&&i){var n=this.props.format;if("hls"===n){var o=e.find(t.adaptiveVideo,{format:"hls"});return a.urlUtils.joinURL(this.props.adaptiveVideoDomain,e.get(o,"url"))}if("mp4"===n){var r=e.keyBy(t.qualities,"quality")[i];return r.url?a.urlUtils.joinURL(this.props.staticVideoUrl,r.url):a.urlUtils.joinURL(this.props.staticVideoUrl,t.videoId,i,"mp4","file.mp4")}}return""},shouldInitiateAdaptive:function(){return"hls"===this.props.format&&"maybe"!==this.refs.video.canPlayType("application/vnd.apple.mpegURL")&&!e.get(this.hls,"media")},initAdaptive:function(){if(this.shouldInitiateAdaptive()){var t=requirejs("hls-light");this.hls=new t(e.clone(this.props.config.hls)),this.hls.attachMedia(this.refs.video),this.hls.on(t.Events.ERROR,this.onHlsError)}},handlePosterVisibilityOnce:function(){!this.refs.video.paused&&this.refs.video.currentTime>0&&(this.refs.video.removeEventListener("timeupdate",this.handlePosterVisibilityOnce),this.props.notifyMediaState({type:r.eventTypes.PLAYSTATE,playbackState:r.playbackTypes.SEEK_PLAYING}),this.refs.video.addEventListener("seeked",this.setPosterState),this.seek(0))},setPosterState:function(){this.refs.video.removeEventListener("seeked",this.setPosterState),this.shouldMute()||(this.refs.video.muted=!1,this.refs.video.addEventListener("volumechange",this.onVolumeChange)),this.props.notifyVideoVisibility(!0)},resetPosterState:function(){this.props.showMedia&&(this.props.notifyVideoVisibility(!1),this.refs.video.addEventListener("timeupdate",this.handlePosterVisibilityOnce))},removeVideoSecurely:function(){this.refs.video.pause(),this.hls&&(this.hls.detachMedia(),this.hls.destroy()),this.refs.video.src="",this.refs.video.load()},canVideoPlay:function(){return this.refs.video.readyState>=this.refs.video.HAVE_CURRENT_DATA},shouldMute:function(){return this.props.showMedia&&this.refs.video?this.refs.video.muted:this.props.compProp.disableAudio||e.get(this.props,["compProp","mute"],e.get(this.props,["compData","mute"]))||!1===this.props.compData.hasAudio},play:function(){this.props.showMedia||this.shouldMute()||(this.refs.video.removeEventListener("volumechange",this.onVolumeChange),this.mute()),this.canVideoPlay()?this.refs.video.play():this.playWhenReady=!0},pause:function(){this.refs.video.pause()},stop:function(){this.pause(),this.seek(0),this.resetPosterState()},setVolume:function(e){this.refs.video.volume=Math.max(0,Math.min(1,e))},mute:function(){this.refs.video.muted=!0},unMute:function(){this.refs.video.muted=this.props.compProp.disableAudio},seek:function(e){this.refs.video.currentTime=Math.max(0,Math.min(e,this.refs.video.duration||this.props.compData.duration))},setRate:function(e){this.refs.video.playbackRate=Math.max(0,e)},onLoadStart:function(){this.props.notifyMediaState({type:r.eventTypes.LOAD,playbackState:r.playbackTypes.READY,volume:this.refs.video.volume,muted:this.refs.video.muted,looped:this.props.compProp.loop,currentTime:this.refs.video.currentTime,progress:0})},onDurationChange:function(){this.props.notifyMediaState({type:r.eventTypes.LOAD,duration:parseInt(100*this.refs.video.duration,10)/100})},onLoadedData:function(){this.playWhenReady||this.props.notifyMediaState({type:r.eventTypes.LOAD,playbackState:r.playbackTypes.IDLE})},onCanPlay:function(){this.playWhenReady&&(this.play(),this.playWhenReady=!1)},onTimeUpdate:function(){this.props.notifyMediaState({type:r.eventTypes.TIME_UPDATE,currentTime:this.refs.video.currentTime})},onPlayEnded:function(){this.props.notifyMediaState({type:r.eventTypes.PLAYSTATE,playbackState:r.playbackTypes.PLAY_ENDED})},onPlay:function(){this.props.notifyMediaState({type:r.eventTypes.PLAYSTATE,playbackState:r.playbackTypes.PLAYING})},onPause:function(){this.props.notifyMediaState({type:r.eventTypes.PLAYSTATE,playbackState:r.playbackTypes.PAUSED})},onHlsError:function(e,t){t.fatal&&(this.refs.video.src="",this.props.notifyMediaState({type:r.eventTypes.ERROR,error:r.errorTypes.NO_HLS_VIDEO}))},onError:function(e){e.currentTarget.networkState===e.currentTarget.NETWORK_NO_SOURCE?(this.refs.video.src="",this.props.notifyMediaState({type:r.eventTypes.ERROR,error:r.errorTypes.NO_VIDEO_FOUND})):this.props.notifyMediaState({type:r.eventTypes.ERROR,error:r.errorTypes.VIDEO_GENERAL_ERROR})},onProgress:function(){var e=this.refs.video.buffered;this.props.notifyMediaState({type:r.eventTypes.PROGRESS,progress:e&&e.length?e.end(e.length-1):0})},onSeekStart:function(){this.props.notifyMediaState({type:r.eventTypes.PLAYSTATE,playbackState:r.playbackTypes.SEEKING})},onSeekEnd:function(){this.props.notifyMediaState({type:r.eventTypes.PLAYSTATE,playbackState:r.playbackTypes.SEEKING_ENDED})},onVolumeChange:function(){this.props.notifyMediaState({type:r.eventTypes.VOLUME,volume:this.refs.video.volume,muted:this.refs.video.muted})},onRateChange:function(){this.props.notifyMediaState({type:r.eventTypes.RATE,playbackRate:this.refs.video.playbackRate})},onVideoClick:function(e){e.stopPropagation()},getVideo:function(){var e={preload:this.props.compData.preload||"none",onEnded:this.onPlayEnded,onError:this.onError,onLoadStart:this.onLoadStart,onLoadedData:this.onLoadedData,onCanPlay:this.onCanPlay,onDurationChange:this.onDurationChange,onPause:this.onPause,onPlay:this.onPlay,onProgress:this.onProgress,onRateChange:this.onRateChange,onSeeked:this.onSeekEnd,onSeeking:this.onSeekStart,onTimeUpdate:this.onTimeUpdate,onClick:this.onVideoClick,playsInline:!this.props.playFullscreen,crossOrigin:"anonymous",style:{visibility:this.props.keepVideoHidden?"hidden":"",position:"absolute",top:0,opacity:this.props.showMedia&&!this.props.keepVideoHidden?1:0}};return this.props.compData.alt&&(e["aria-label"]=this.props.compData.alt),this.shouldMute()&&(e.muted="muted"),e},getRenderParts:function(){var t=this,i={video:null,poster:null},a={containerWidth:this.props.posterWidth||0,containerHeight:this.props.posterHeight||0,shouldRenderSrc:this.props.shouldRenderSrc,imageUrlPreMeasureParams:this.props.imageUrlPreMeasureParams,filterEffect:this.props.filterEffect,containerId:this.props.parentId};return e.forEach(this.props.videoRenderParts,function(e){switch(e){case"video":i.video=t.getVideo();break;case"poster":i.poster=t.getPosterImageComp(t.props.compData.posterImageRef,t.props.showMedia,a)}}),i},getSkinProperties:function(){var t=this.getRenderParts();return{"":e.assign(d(this.props),{style:{position:"absolute",width:"100%",height:"100%",top:0}}),video:t.video,poster:t.poster}}}}.apply(t,a))||(e.exports=n)},174:function(e,t,i){var a,n;function o(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}a=[i(0),i(1),i(2)],void 0===(n=function(e,t,i){"use strict";var a=t.mediaConsts.balataConsts,n={unsharpMask:{radius:.33,amount:1,threshold:0}};return{mixins:[i.mixins.animationsMixin],externalAPI:["play","pause","stop","seek","setVolume","mute","unMute","setRate","setSrc"],mediaAPI:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=this[t];a&&e.includes(this.externalAPI,t)&&a.apply(void 0,o(i))},getPosterImageComp:function(t,i,o){var r=this.props.hasBgScrollEffect,s={position:"absolute",top:0,width:"100%",height:"100%"};return i&&"fade"===this.props.compProp.animatePoster?this.animate(this.refs.poster,"BaseFade",1.6,0,{opacity:0,ease:"Quad.easeOut"}):s.opacity=i?0:1,this.createChildComponent(t,"core.components.Image",a.POSTER,e.assign({ref:a.POSTER,key:s.backgroundColor?"posterImagePng":"posterImage",id:this.props.id+a.POSTER,imageData:e.assign({},t,{quality:n,devicePixelRatio:1}),hasBgScrollEffect:r,displayMode:this.props.fittingType,alignType:this.props.alignType,autoLayout:!0,wixImageLayout:this.props.isExperimentOpen("bv_wixImagePhaseTwo"),style:s},o))}}}.apply(t,a))||(e.exports=n)},175:function(e,t,i){var a,n;a=[i(0),i(4),i(3),i(1),i(405)],void 0===(n=function(e,t,i,a,n){"use strict";var o=a.svgFilters,r=a.mediaConsts;function s(e,t){var i=!1;t=t||{};var a=e.brightnessContrast,o=e.duotone,r=e.hueSaturation;return"brightness"in t||"contrast"in t?(a||(a=n.effects.brightnessContrast(),e.splice(1,0,a),e.brightnessContrast=a,i=!0),t.brightness||0===t.brightness?(a.brightness=t.brightness,a.brightnessDsiabled=!1):a.brightnessDsiabled=!0,t.contrast||0===t.contrast?(a.contrast=t.contrast,a.contrastDisabled=!1):a.contrastDisabled=!0):a&&(a.brightnessDsiabled=!0,a.contrastDisabled=!0),t.duotoneDark&&t.duotoneLight?(o||(o=n.effects.duotone(),e.splice(a?2:1,0,o),e.duotone=o,i=!0),o.dark=l(t.duotoneDark),o.light=l(t.duotoneLight),o.disabled=!1):o&&(o.disabled=!0),"hue"in t||"saturation"in t?(r||(r=n.effects.hueSaturation(),e.push(r),e.hueSaturation=r,i=!0),t.hue||0===t.hue?(r.hue=t.hue,r.hueDisabled=!1):r.hueDisabled=!0,t.saturation||0===t.saturation?(r.saturation=t.saturation,r.saturationDisabled=!1):r.saturationDisabled=!0):r&&(r.hueDisabled=!0,r.saturationDisabled=!0),i}function d(e){var t=function(e){var t=[n.effects.transparentVideo()];if("brightness"in e||"contrast"in e){var i=n.effects.brightnessContrast();t.push(i),t.brightnessContrast=i}if(e.duotoneDark&&e.duotoneLight){var a=n.effects.duotone();t.push(a),t.duotone=a}if("hue"in e||"saturation"in e){var o=n.effects.hueSaturation();t.push(o),t.hueSaturation=o}return t}(e);return s(t,e),t}function p(e){if(e){var t=function(e){return e&&e.effectType?o.getProperties(e.effectType).reduce(function(e,t){var i={};return t&&(t.duotone?(i.duotoneDark=t.duotone.dark,i.duotoneLight=t.duotone.light):i=t),Object.assign(e,i),e},{}):{}}(e);return Object.assign(t,e),t}return{}}function l(e){if("string"==typeof e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,1]:e}return e}function u(e,t){var i=e.props;return{type:"video",width:i.mediaWidth,height:i.mediaHeight,media:t=t||i.getMediaSource()}}return n.Vgl.prototype.play=function(){var e=this,t=!0;this.animationFrameId||(this.animationFrameId=window.requestAnimationFrame(function i(){e.animationFrameId=window.requestAnimationFrame(i);var a=e.media;a&&a.readyState>=a.HAVE_CURRENT_DATA&&(t||!a.paused&&!a.ended)&&(t=!1,e.draw())}))},{displayName:"webglMedia",mixins:[i.mixins.skinBasedComp],propTypes:{playerStyle:t.object,notifyMediaState:t.func,getMediaSource:t.func,mediaWidth:t.number,mediaHeight:t.number,showMedia:t.bool,filterEffect:t.object,notifyWebGLVisibility:t.func,getIsVisible:t.func,addVisibilityStateListener:t.func,addWebGLContext:t.func,removeWebGLContext:t.func},getDefaultProps:function(){return{playerStyle:{}}},getInitialState:function(){return this.vgl=null,this.isVisible=null,{}},getIsVisible:function(){return null===this.isVisible&&(this.isVisible=this.props.getIsVisible()),this.isVisible},componentDidMount:function(){var e=this;this.removeVisibilityStateListener=this.props.addVisibilityStateListener(function(t){t.in&&t.isPlayingAllowed?(e.isVisible=!0,e.initVglInstance()):e.vgl&&(e.isVisible=!1,e.destroyVglInstance())})},componentDidUpdate:function(){var e=this.getIsVisible(),t=this.vgl&&this.vgl.gl;e?t?this.updateVglInstance():this.initVglInstance():t&&this.destroyVglInstance()},componentWillUnmount:function(){this.vgl&&(this.vgl.gl&&this.vgl.destroy(),this.vgl=null,this.props.removeWebGLContext()),this.removeVisibilityStateListener(),this.removeVisibilityStateListener=function(){}},initVglInstance:function(){var e=this;if(this.props.addWebGLContext()){if(this.vgl)this.vgl.lostContext?this.vgl.restoreContext():(s(this.vgl.config.effects,p(this.props.filterEffect)),this.vgl.init(),this.vgl.setSource(this.vgl._source||u(this,this.vgl.media)),delete this.vgl._source),this.vgl.play();else{var t=this.refs.canvas,i=d(p(this.props.filterEffect));try{this.vgl=new n.Vgl({target:t,effects:i,onContextLost:function(){e.getIsVisible()&&e.initVglInstance()}}),this.vgl.setSource(u(this)),this.vgl.play()}catch(e){this.props.removeWebGLContext(),this.props.notifyMediaState({type:r.eventTypes.ERROR,error:r.errorTypes.WEBGL_ERROR})}}this.props.showMedia||this.props.notifyWebGLVisibility(!0)}else this.props.notifyWebGLVisibility(!1)},updateVglInstance:function(){if(this.vgl){var e=this.props,t=e.getMediaSource();if(t){var i=u(this,t),a=!0;if(!this.vgl.lostContext&&this.vgl.gl){try{this.vgl.setSource(i),this.vgl.play(),this.props.showMedia||this.props.notifyWebGLVisibility(!0)}catch(e){a=!1,this.props.notifyMediaState({type:r.eventTypes.ERROR,error:r.errorTypes.WEBGL_ERROR})}if(a){var n=e.filterEffect;s(this.vgl.config.effects,p(n))&&this.vgl.init()}}}}},destroyVglInstance:function(){this.vgl.destroy(!0),this.props.removeWebGLContext()},getSkinProperties:function(){return{"":{style:{position:"absolute",width:"100%",height:"100%",top:0,overflow:"hidden"}},canvas:{style:{position:"absolute",opacity:this.props.showMedia?1:0}}}}}}.apply(t,a))||(e.exports=n)},2:function(e,t){e.exports=i},22:function(e,t){e.exports=s},3:function(e,t){e.exports=a},38:function(e,t){e.exports=d},4:function(e,t){e.exports=n},402:function(e,t,i){var a,n;a=[i(403),i(172),i(404),i(406),i(173),i(175),i(407),i(5),i(409),i(3)],void 0===(n=function(e,t,i,a,n,o,r,s,d,p){"use strict";var l={mixins:{backgroundDetectionMixin:e},components:{bgImage:t,bgMedia:i,bgOverlay:a,html5Video:n,webglMedia:o,iframeVideo:r}};return p.compRegistrar.register("wysiwyg.viewer.components.background.bgMedia",l.components.bgMedia).register("wysiwyg.viewer.components.background.bgImage",l.components.bgImage).register("wysiwyg.viewer.components.background.html5Video",l.components.html5Video).register("wysiwyg.viewer.components.background.webglMedia",l.components.webglMedia).register("wysiwyg.viewer.components.background.iframeVideo",l.components.iframeVideo).register("wysiwyg.viewer.components.background.bgOverlay",l.components.bgOverlay),s.skinsMap.addBatch(d),l}.apply(t,a))||(e.exports=n)},403:function(e,t,i){var a,n;a=[i(2),i(0),i(1),i(38)],void 0===(n=function(e,t,i,a){"use strict";function n(e){return t.get(e.compDesign,"background")||t.get(e.compData,"background",{})}function o(){var e=n(this.props);return new a(i.colorParser.getColor(this.props.colorsMap,e.color,e.colorOpacity))}function r(e,t){var a=e&&e.uri,n=a!==this.lastBackgroundImageUrl,r=t&&t.hexString(),s=this.lastBackgroundBgColor&&this.lastBackgroundBgColor.hexString(),d=!a&&r!==s,p=t&&t.values.alpha!==this.lastAlpha;(n||d||p)&&function(e){var t=e&&e.uri;if(t){var a={id:t,width:e.width,height:e.height},n=i.imageClientApi,r=n.getData(n.fittingTypes.SCALE_TO_FILL,a,{width:1,height:1}).uri,s=this.props.getMediaFullStaticUrl(r);this.props.updateImageInfo(this.props.id,this.props.rootId,s)}else{var d=o.call(this);this.props.updateColorInfo(this.props.id,this.props.rootId,{brightness:d.values.hsv[2],alpha:d.values.alpha})}}.call(this,e),this.lastBackgroundImageUrl=a,this.lastBackgroundBgColor=t,this.lastAlpha=t.values.alpha}return{propTypes:{id:e.santaTypesDefinitions.Component.id,compDesign:e.santaTypesDefinitions.Component.compDesign,compData:e.santaTypesDefinitions.Component.compData,colorsMap:e.santaTypesDefinitions.Theme.colorsMap.isRequired,isMobileView:e.santaTypesDefinitions.isMobileView.isRequired,updateColorInfo:e.santaTypesDefinitions.VerticalAnchorsMenu.updateInformation.isRequired,updateImageInfo:e.santaTypesDefinitions.VerticalAnchorsMenu.updateImageInfo.isRequired,getMediaFullStaticUrl:e.santaTypesDefinitions.ServiceTopology.getMediaFullStaticUrl.isRequired},componentDidMount:function(){if(!this.props.isMobileView){var e=o.call(this),t=this.getMediaImageData();r.call(this,t,e)}},componentDidUpdate:function(){if(!this.props.isMobileView){var e=o.call(this),t=e&&e.hexString(),i=this.lastBackgroundBgColor&&this.lastBackgroundBgColor.hexString(),a=this.getMediaImageData(),n=t!==i,s=(a&&a.uri)!==this.lastBackgroundImageUrl,d=e&&e.values.alpha!==this.lastAlpha;(n||s||d)&&r.call(this,a,e)}},getMediaImageData:function(){var e=n(this.props).mediaRef;if(e)switch(e.type){case"Image":return e;case"WixVideo":return e.posterImageRef}return null}}}.apply(t,a))||(e.exports=n)},404:function(e,t,i){var a,n;a=[i(0),i(4),i(3),i(2),i(22),i(172),i(173),i(175),i(1)],void 0===(n=function(e,t,i,a,n,o,r,s,d){"use strict";var p=d.mediaConsts,l=d.svgFilters,u=d.containerBackgroundUtils,c=d.colorParser,h=n.fittingTypes,f=p.balataConsts,m=f.POSTER,y=f.IMAGE,g=f.BG_IMAGE,v=f.VIDEO,b=f.WEBGL,S=f.IMAGE_BG_PARAMS,T=f.IMAGE_PARAMS,E=f.VIDEO_PARAMS,x=f.WEBGL_PARAMS,k=f.IFRAME_VIDEO_PARAMS,M={image:{componentType:T.comp,skinPartData:{skin:T.skin,styleId:T.style}},bg_image:{componentType:S.comp,skinPartData:{skin:S.skin,styleId:S.style}},poster:{componentType:T.comp,skinPartData:{skin:T.skin,styleId:T.style}},video:{componentType:E.comp,skinPartData:{skin:E.skin,styleId:E.style}},webgl:{componentType:x.comp,skinPartData:{skin:x.skin,styleId:x.style}},iframe:{componentType:k.comp,skinPartData:{skin:k.skin,styleId:k.style}}};function D(t,i){var a=i.filterEffect,n=u.isFullScreenByEffect(t.bgEffectName,t.renderFixedPositionBackgrounds);return{ref:y,id:t.id+y,containerId:t.parentId,autoLayout:!0,wixImageLayout:t.isExperimentOpen("bv_wixImagePhaseTwo"),key:"img_"+t.bgEffectName,style:{position:"absolute",top:0,width:"100%",height:"100%"},containerWidth:e.get(t.mediaDimensions,"width",0),containerHeight:e.get(t.mediaDimensions,"height",0),imageUrlPreMeasureParams:t.imageUrlPreMeasureParams,shouldRenderSrc:t.shouldRenderSrc,imageData:t.compData,filterEffect:a,displayMode:t.fittingType,hasBgScrollEffect:n,fittingType:t.fittingType,alignType:t.alignType,"data-type":T["data-type"]}}function P(t,i){var a=i.registerMediaSource,n=i.notifyVideoVisibility,o=i.showMedia,r=i.filterEffect,s={ref:v,id:t.id+v,parentId:t.parentId,style:e.pick(t.style,["width","height"]),key:"vid_"+t.compData.videoId,notifyMediaState:t.notifyMediaState,isPlayingAllowed:t.isPlayingAllowed,setMediaAPI:t.setMediaAPI,mediaQuality:t.mediaQuality,format:t.playbackFormat,config:t.playbackConfig,playbackUrl:t.playbackUrl,videoRenderParts:t.renderParts.media.video,compProp:t.compProp,keepVideoHidden:e.includes(t.compData.mediaFeatures,"alpha"),notifyVideoVisibility:n,posterWidth:e.get(t.mediaDimensions,"width",0),posterHeight:e.get(t.mediaDimensions,"height",0),imageUrlPreMeasureParams:t.imageUrlPreMeasureParams,shouldRenderSrc:t.shouldRenderSrc,filterEffect:r,hasBgScrollEffect:u.isFullScreenByEffect(t.bgEffectName,t.renderFixedPositionBackgrounds),fittingType:t.fittingType,alignType:t.alignType,showMedia:o};return a&&(s.registerMediaSource=a),s}function R(t){var i=t.compData,a=t.enableVideo;return"Image"===i.type?function(e){var t=e.fittingType,i=e.cssFiltersSupported,a=e.filterEffect,n=a&&l.isFilterExists(a.effectType);return t===h.TILE&&(n&&i||!n)}(t)?g:y:"WixVideo"===i.type?a?e.includes(i.mediaFeatures,"alpha")&&t.renderParts.media.video.length?b:v:m:void 0}return{displayName:"bgMedia",mixins:[i.mixins.skinBasedComp,i.mixins.createChildComponentMixin],propTypes:e.defaults({id:t.string.isRequired,compData:t.object.isRequired,compProp:t.object,parentId:t.string.isRequired,alignType:t.string,fittingType:t.string,mediaTransforms:t.object,filterEffect:t.object,bgEffectName:t.string,style:t.object.isRequired,playerStyle:t.object,isPlayingAllowed:t.bool,enableVideo:t.bool,mediaQuality:t.string,renderParts:t.object,notifyMediaState:t.func,setMediaAPI:t.func,isExperimentOpen:a.santaTypesDefinitions.isExperimentOpen.isRequired,getIsVisible:t.func,addVisibilityStateListener:t.func,addWebGLContext:t.func,removeWebGLContext:t.func,colorsMap:a.santaTypesDefinitions.Theme.colorsMap,cssFiltersSupported:a.santaTypesDefinitions.BrowserFlags.cssFiltersSupported.isRequired,renderFixedPositionBackgrounds:a.santaTypesDefinitions.RenderFlags.renderFixedPositionBackgrounds},a.utils.santaTypesUtils.getSantaTypesFromPropTypes(a.components.Image.propTypes),a.utils.santaTypesUtils.getSantaTypesByDefinition(o),a.utils.santaTypesUtils.getSantaTypesByDefinition(r),a.utils.santaTypesUtils.getSantaTypesByDefinition(s)),getInitialState:function(){return{mediaSource:null,showMedia:!1,showVideo:!1,showWebGL:!0}},getMediaComponentsDescriptors:function(){var t=[],i=this.props.compData,a=R(this.props),n=function(t,i){return e.isPlainObject(t)?e.mapValues(t,function(e){return c.isThemeColor(e)?c.getHexColor(i,e):e}):t}(this.props.filterEffect,this.props.colorsMap);switch(a){case y:var o=D(this.props,{filterEffect:n}),r=e.assign({},M.image,{extraProps:o,compData:i});t.push(r);break;case g:var s=function(t,i){var a=i.filterEffect;return{ref:y,id:t.id+y,filterEffect:a,style:e.pick(t.style,["width","height"]),mediaDimensions:t.mediaDimensions,imageUrlPreMeasureParams:t.imageUrlPreMeasureParams,shouldRenderSrc:t.shouldRenderSrc,imageData:t.compData,fittingType:t.fittingType,alignType:t.alignType,"data-type":S["data-type"]}}(this.props,{filterEffect:n}),d=e.assign({},M.bg_image,{extraProps:s,compData:i});t.push(d);break;case v:var p={showMedia:this.state.showMedia,notifyVideoVisibility:this.notifyVideoVisibility,filterEffect:n},l=P(this.props,p),u=e.assign({},M.video,{extraProps:l,compData:i});t.push(u);break;case b:var h={showMedia:this.state.showMedia,notifyWebGLVisibility:this.notifyWebGLVisibility,getMediaSource:this.getMediaSource,filterEffect:n},f=function(t,i){var a=i.getMediaSource,n=i.notifyWebGLVisibility,o=i.showMedia,r=i.filterEffect,s=e.find(t.compData.qualities,{quality:t.mediaQuality}),d=s.width,p=s.height;return{ref:b,id:t.id+b,key:"gl_"+t.compData.videoId,getMediaSource:a,showMedia:o,notifyMediaState:t.notifyMediaState,mediaWidth:d,mediaHeight:p,playerStyle:t.playerStyle,filterEffect:r,notifyWebGLVisibility:n,getIsVisible:t.getIsVisible,addVisibilityStateListener:t.addVisibilityStateListener,addWebGLContext:t.addWebGLContext,removeWebGLContext:t.removeWebGLContext}}(this.props,h),T=e.assign({},M.webgl,{extraProps:f,compData:i});t.push(T);var E={showMedia:this.state.showMedia,notifyVideoVisibility:this.notifyVideoVisibility,registerMediaSource:this.registerMediaSource,filterEffect:n},x=P(this.props,E),k=e.assign({},M.video,{extraProps:x,compData:i});t.push(k);break;case m:var _=D(this.props,{filterEffect:n});_.imageData=i.posterImageRef;var V=e.assign({},M.poster,{extraProps:_,compData:i.posterImageRef});t.push(V)}return t},getMediaComponents:function(){var t=this,i=this.getMediaComponentsDescriptors();return e.map(i,function(e){var i=e.compData,a=e.componentType,n=e.skinPartData,o=e.extraProps;return t.createChildComponent(i,a,n,o)})},getMediaSource:function(){return this.state.mediaSource},registerMediaSource:function(e){e!==this.state.mediaSource&&this.setState({mediaSource:e})},notifyVideoVisibility:function(e){e!==this.state.showVideo&&this.setState({showVideo:e,showMedia:e&&this.state.showWebGL})},notifyWebGLVisibility:function(e){e!==this.state.showWebGL&&this.setState({showWebGL:e,showMedia:e&&this.state.showVideo})},getSkinProperties:function(){var t=this.getMediaComponents(),i=this.props.bgEffectName?"media_"+(this.props.isPlayingAllowed?"playback":"no_playback")+"_"+(this.props.enableVideo?"video":"no_video"):"bgMedia",a=e.mapKeys(this.props.mediaTransforms,function(e,t){return"data-"+t});return{"":e.assign({key:i,children:t,style:this.props.style,"data-has-bg-effect":u.isFullScreenByEffect(this.props.bgEffectName,this.props.renderFixedPositionBackgrounds)?"1":"","data-fitting":this.props.fittingType,"data-align":this.props.alignType,"data-media-comp-type":R(this.props)},a)}}}}.apply(t,a))||(e.exports=n)},405:function(e,t,i){var a,n,o,r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],a=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(a=(r=s.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){n=!0,o=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}o=function(){"use strict";var e={init:function(e,r,s){var d=function(e,r){var s={texture:o(e).texture,buffer:null};e.bindTexture(e.TEXTURE_2D,s.texture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0);var d=function(e){return e.reduce(function(e,t){var i,a,n=t.attributes,o=void 0===n?[]:n,r=t.uniforms,s=void 0===r?[]:r,d=t.textures,p=void 0===d?[]:d,u=t.varying,c=void 0===u?{}:u,h=function(i){return Object.keys(t[i]).forEach(function(a){"constant"===a||"main"===a?e[i][a]+=t[i][a]+"\n":e[i][a]=Object.assign(e[i][a],t[i][a])})};return h("vertexSrc"),h("fragmentSrc"),o.forEach(function(t){var i=e.attributes.some(function(e,i){if(e.name===t.name)return Object.assign(e,t),!0});i||e.attributes.push(t)}),(i=e.uniforms).push.apply(i,l(s)),(a=e.textures).push.apply(a,l(p)),Object.assign(e.vertexSrc.varying,c),Object.assign(e.fragmentSrc.varying,c),e},{vertexSrc:{uniform:{},attribute:{},varying:{},constant:"",main:""},fragmentSrc:{uniform:{},varying:{},constant:"",main:""},attributes:[{name:"a_position",data:new Float32Array([-1,-1,-1,1,1,-1,1,1]),size:2,type:"FLOAT"},{name:"a_texCoord",data:new Float32Array([0,0,0,1,1,0,1,1]),size:2,type:"FLOAT"}],uniforms:[{name:"u_source",size:1,type:"i",data:[0]}],textures:[]})}(r),p=a(d.vertexSrc,t),u=a(d.fragmentSrc,i),c=function(e,t,i){var a=n(e,e.VERTEX_SHADER,t),o=n(e,e.FRAGMENT_SHADER,i);if(a.error)return a;if(o.error)return o;return function(e,t,i){var a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,i),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS))return{program:a,vertexShader:t,fragmentShader:i};var n={error:e.getProgramInfoLog(a),type:"program"};return e.deleteProgram(a),n}(e,a,o)}(e,p,u),h=c.program,f=c.vertexShader,m=c.fragmentShader,y=c.error,g=c.type;if(y)throw new Error(g+" error:: "+y);var v=function(e,t,i){return(i||[]).map(function(i){var a=function(e,t,i,a){var n=e.getAttribLocation(t,i),o=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,a,e.STATIC_DRAW),{location:n,buffer:o}}(e,t,i.name,i.data),n=a.location,o=a.buffer;return{name:i.name,location:n,buffer:o,type:i.type,size:i.size}})}(e,h,d.attributes),b=function(e,t,i){return(i||[]).map(function(i){var a=e.getUniformLocation(t,i.name);return{location:a,size:i.size,type:i.type,data:i.data}})}(e,h,d.uniforms);return{program:h,vertexShader:f,fragmentShader:m,source:s,attributes:v,uniforms:b,textures:d.textures}}(e,r);return{gl:e,data:d,dimensions:s||{}}},draw:function(e,t,i,a){if(t.readyState<t.HAVE_CURRENT_DATA)return;var n=i.program,o=i.source,r=i.attributes,s=i.uniforms,d=i.textures;if(e.bindTexture(e.TEXTURE_2D,o.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGB,e.RGB,e.UNSIGNED_BYTE,t),e.useProgram(n),function(e,t){(t||[]).forEach(function(t){var i=t.location,a=t.buffer,n=t.size,o=t.type;e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(i,n,e[o],!1,0,0)})}(e,r),function(e,t){(t||[]).forEach(function(t){var i=t.size,a=t.type,n=t.location,o=t.data;e["uniform"+i+a+"v"](n,o)})}(e,s),d)for(var p=-1;p<d.length;p++)e.activeTexture(e.TEXTURE0+(p+1)),e.bindTexture(e.TEXTURE_2D,-1===p?o.texture:d[p].texture);e.drawArrays(e.TRIANGLE_STRIP,0,4)},destroy:function(e,t){var i=t.program,a=t.vertexShader,n=t.fragmentShader,o=t.source;(t.attributes||[]).forEach(function(t){return e.deleteBuffer(t.buffer)}),e.deleteTexture(o.texture),e.deleteProgram(i),e.deleteShader(a),e.deleteShader(n)},resize:function(e,t){var i=e.canvas,a=t||{},n=a.width,o=a.height,r=void 0,s=void 0;n&&o?(r=n,s=o):(r=Math.floor(1*i.clientWidth),s=Math.floor(1*i.clientHeight));i.width===r&&i.height===s||(i.width=r,i.height=s);e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight)},getWebGLContext:function(e){var t=void 0,i={preserveDrawingBuffer:!1,antialias:!1,depth:!1,stencil:!1};(t=e.getContext("webgl",i))||(t=e.getContext("experimental-webgl",i));return t},createTexture:o},t=function(e){var t=e.uniform,i=void 0===t?"":t,a=e.attribute,n=void 0===a?"":a,o=e.varying,r=void 0===o?"":o,s=e.constant,d=void 0===s?"":s,p=e.main;return"\nprecision mediump float;\n"+i+"\n"+n+"\nattribute vec2 a_texCoord;\nattribute vec2 a_position;\n"+r+"\nvarying vec2 v_texCoord;\n\nconst vec3 lumcoeff = vec3(0.2125, 0.7154, 0.0721);\n"+d+"\nvoid main() {\n    v_texCoord = a_texCoord;\n    "+(void 0===p?"":p)+"\n    gl_Position = vec4(a_position.xy, 0.0, 1.0);\n}"},i=function(e){var t=e.uniform,i=void 0===t?"":t,a=e.varying,n=void 0===a?"":a,o=e.constant,r=void 0===o?"":o,s=e.main;return"\nprecision mediump float;\n"+n+"\nvarying vec2 v_texCoord;\n"+i+"\nuniform sampler2D u_source;\n\nconst vec3 lumcoeff = vec3(0.2125, 0.7154, 0.0721);\n"+r+"\nvoid main() {\n    vec4 pixel = texture2D(u_source, v_texCoord);\n    vec3 color = pixel.rgb;\n    float alpha = pixel.a;\n    "+(void 0===s?"":s)+"\n    gl_FragColor = vec4(color, 1.0) * alpha;\n}"};function a(e,t){return t(Object.entries(e).reduce(function(e,t){var i=s(t,2),a=i[0],n=i[1];return["uniform","attribute","varying"].includes(a)?e[a]=Object.entries(n).reduce(function(e,t){var i=s(t,2),n=i[0],o=i[1];return e+(a+" ")+o+" "+n+";\n"},""):e[a]=n,e},{}))}function n(e,t,i){var a=e.createShader(t);if(e.shaderSource(a,i),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS))return a;var n={error:e.getShaderInfoLog(a),type:t===e.VERTEX_SHADER?"VERTEX":"FRAGMENT"};return e.deleteShader(a),n}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.width,a=void 0===i?1:i,n=t.height,o=void 0===n?1:n,r=t.data,s=void 0===r?null:r,d=t.format,p=void 0===d?"RGBA":d,l=e.createTexture();return e.bindTexture(e.TEXTURE_2D,l),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),s?e.texImage2D(e.TEXTURE_2D,0,e[p],e[p],e.UNSIGNED_BYTE,s):e.texImage2D(e.TEXTURE_2D,0,e[p],a,o,0,e[p],e.UNSIGNED_BYTE,null),{texture:l,width:a,height:o}}var d=function(){function e(){p(this,e),this.pool=[]}return r(e,[{key:"start",value:function(){var e=this;if(!this.animationFrameId){this.animationFrameId=window.requestAnimationFrame(function t(){e.animationFrameId=window.requestAnimationFrame(t),e.draw()})}}},{key:"stop",value:function(){window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null}},{key:"draw",value:function(){this.pool.forEach(function(e){return e.draw()})}},{key:"add",value:function(e){~this.pool.indexOf(e)||this.pool.push(e)}},{key:"remove",value:function(e){var t=this.pool.indexOf(e);~t&&this.pool.splice(t,1)}}]),e}();return{effects:{transparentVideo:function(){return{vertexSrc:{uniform:{u_texOffset:"vec2"},main:"v_texAlphaCoord = v_texCoord + u_texOffset;"},fragmentSrc:{uniform:{u_tvEnabled:"bool"},main:"\n    if (u_tvEnabled) {\n        alpha *= dot(lumcoeff, texture2D(u_source, v_texAlphaCoord).rgb);\n    \n        if (alpha < 0.04) {\n            alpha = 0.0;\n        }\n        else if (alpha > 0.96) {\n            alpha = 1.0;\n        }\n    }"},get disabled(){return!this.uniforms[0].data},set disabled(e){return this.uniforms[0].data[0]=+!e},varying:{v_texAlphaCoord:"vec2"},uniforms:[{name:"u_tvEnabled",size:1,type:"i",data:[1]},{name:"u_texOffset",size:2,type:"f",data:[0,-.5]}],attributes:[{name:"a_texCoord",data:new Float32Array([0,.5,0,1,1,.5,1,1]),size:2,type:"FLOAT"}]}},alphaMask:function(){return{vertexSrc:{attribute:{a_alphaMaskTexCoord:"vec2"},main:"\n    v_alphaMaskTexCoord = a_alphaMaskTexCoord;"},fragmentSrc:{uniform:{u_alphaMaskEnabled:"bool",u_mask:"sampler2D"},main:"\n    if (u_alphaMaskEnabled) {\n        alpha *= texture2D(u_mask, v_alphaMaskTexCoord).a;\n    }"},get disabled(){return!this.uniforms[0].data},set disabled(e){return this.uniforms[0].data[0]=+!e},varying:{v_alphaMaskTexCoord:"vec2"},uniforms:[{name:"u_alphaMaskEnabled",size:1,type:"i",data:[1]},{name:"u_mask",size:1,type:"i",data:[1]}],attributes:[{name:"a_alphaMaskTexCoord",data:new Float32Array([0,0,0,1,1,0,1,1]),size:2,type:"FLOAT"}],textures:[{format:"ALPHA"}]}},brightnessContrast:function(){return{vertexSrc:{},fragmentSrc:{uniform:{u_brEnabled:"bool",u_ctEnabled:"bool",u_contrast:"float",u_brightness:"float"},constant:"const vec3 half3 = vec3(0.5);",main:"\n    if (u_brEnabled) {\n        color *= u_brightness;\n    }\n\n    if (u_ctEnabled) {\n        color = (color - half3) * u_contrast + half3;\n    }\n\n    color = clamp(color, 0.0, 1.0);"},get brightness(){return this.uniforms[2].data[0]},set brightness(e){this.uniforms[2].data[0]=parseFloat(Math.max(0,e))},get contrast(){return this.uniforms[3].data[0]},set contrast(e){this.uniforms[3].data[0]=parseFloat(Math.max(0,e))},get brightnessDisabled(){return!this.uniforms[0].data},set brightnessDisabled(e){return this.uniforms[0].data[0]=+!e},get contrastDisabled(){return!this.uniforms[1].data},set contrastDisabled(e){return this.uniforms[1].data[0]=+!e},uniforms:[{name:"u_brEnabled",size:1,type:"i",data:[1]},{name:"u_ctEnabled",size:1,type:"i",data:[1]},{name:"u_brightness",size:1,type:"f",data:[1]},{name:"u_contrast",size:1,type:"f",data:[1]}]}},hueSaturation:function(){return{vertexSrc:{uniform:{u_hue:"float",u_saturation:"float"},constant:"\nconst mat3 lummat = mat3(\n    lumcoeff,\n    lumcoeff,\n    lumcoeff\n);\nconst mat3 cosmat = mat3(\n    vec3(0.787, -0.715, -0.072),\n    vec3(-0.213, 0.285, -0.072),\n    vec3(-0.213, -0.715, 0.928)\n);\nconst mat3 sinmat = mat3(\n    vec3(-0.213, -0.715, 0.928),\n    vec3(0.143, 0.140, -0.283),\n    vec3(-0.787, 0.715, 0.072)\n);\nconst mat3 satmat = mat3(\n    vec3(0.787, -0.715, -0.072),\n    vec3(-0.213, 0.285, -0.072),\n    vec3(-0.213, -0.715, 0.928)\n);",main:"\n    float angle = (u_hue / 180.0) * 3.14159265358979323846264;\n    v_hueRotation = lummat + cos(angle) * cosmat + sin(angle) * sinmat;\n    v_saturation = lummat + satmat * u_saturation;"},fragmentSrc:{uniform:{u_hueEnabled:"bool",u_satEnabled:"bool",u_hue:"float",u_saturation:"float"},main:"\n    if (u_hueEnabled) {\n        color = vec3(\n            dot(color, v_hueRotation[0]),\n            dot(color, v_hueRotation[1]),\n            dot(color, v_hueRotation[2])\n        );\n    }\n\n    if (u_satEnabled) {\n        color = vec3(\n            dot(color, v_saturation[0]),\n            dot(color, v_saturation[1]),\n            dot(color, v_saturation[2])\n        );\n    }\n    \n    color = clamp(color, 0.0, 1.0);"},varying:{v_hueRotation:"mat3",v_saturation:"mat3"},get hue(){return this.uniforms[2].data[0]},set hue(e){this.uniforms[2].data[0]=parseFloat(e)},get saturation(){return this.uniforms[3].data[0]},set saturation(e){this.uniforms[3].data[0]=parseFloat(Math.max(0,e))},get hueDisabled(){return!this.uniforms[0].data},set hueDisabled(e){return this.uniforms[0].data[0]=+!e},get saturationDisabled(){return!this.uniforms[1].data},set saturationDisabled(e){return this.uniforms[1].data[0]=+!e},uniforms:[{name:"u_hueEnabled",size:1,type:"i",data:[1]},{name:"u_satEnabled",size:1,type:"i",data:[1]},{name:"u_hue",size:1,type:"f",data:[0]},{name:"u_saturation",size:1,type:"f",data:[1]}]}},duotone:function(){return{vertexSrc:{},fragmentSrc:{uniform:{u_duotoneEnabled:"bool",u_light:"vec4",u_dark:"vec4"},main:"\n    if (u_duotoneEnabled) {\n        vec3 gray = vec3(dot(lumcoeff, color));\n        color = mix(u_dark.rgb, u_light.rgb, gray);\n    }"},get light(){return this.uniforms[1].data.slice(0)},set light(e){var t=this;e.forEach(function(e,i){Number.isNaN(e)||(t.uniforms[1].data[i]=e)})},get dark(){return this.uniforms[2].data.slice(0)},set dark(e){var t=this;e.forEach(function(e,i){Number.isNaN(e)||(t.uniforms[2].data[i]=e)})},get disabled(){return!this.uniforms[0].data},set disabled(e){return this.uniforms[0].data[0]=+!e},uniforms:[{name:"u_duotoneEnabled",size:1,type:"i",data:[1]},{name:"u_light",size:4,type:"f",data:[.9882352941,.7333333333,.05098039216,1]},{name:"u_dark",size:4,type:"f",data:[.7411764706,.0431372549,.568627451,1]}]}}},Vgl:function(){function t(e){var i=this;p(this,t),this.init(e),this._restoreContext=function(t){t&&t.preventDefault(),i.config.target.removeEventListener("webglcontextrestored",i._restoreContext,!0),i.init(),i._source&&i.setSource(i._source),delete i._source,e&&e.onContextRestored&&e.onContextRestored.call(i,e)},this._loseContext=function(t){t.preventDefault(),i.gl&&i.gl.isContextLost()&&(i.lostContext=!0,i.config.target.addEventListener("webglcontextrestored",i._restoreContext,!0),i.destroy(!0),e&&e.onContextLost&&e.onContextLost.call(i,e))},this.config.target.addEventListener("webglcontextlost",this._loseContext,!0)}return r(t,[{key:"init",value:function(t){var i=t=t||this.config,a=i.target,n=i.effects,o=i.ticker;this.lostContext=!1;var r=e.getWebGLContext(a);r.isContextLost()&&(this.restoreContext(),r=e.getWebGLContext(this.config.target));var s=e.init(r,n,this.dimensions).data;this.gl=r,this.data=s,this.config=t,o&&(this.ticker=o,o.add(this))}},{key:"setSource",value:function(t){if(t){this.lostContext&&this.restoreContext();var i=void 0,a=void 0,n=void 0,o=void 0;"[object Object]"===Object.prototype.toString.call(t)?(i=t.type,a=t.media,n=t.width,o=t.height):a=t,n&&o&&(this.dimensions={width:n,height:o}),e.resize(this.gl,this.dimensions),this._createTextures(),this.media=a,this.type=i||this.type}}},{key:"draw",value:function(){this.lostContext&&this.restoreContext(),e.draw(this.gl,this.media,this.data,this.dimensions)}},{key:"play",value:function(){var e=this;if(this.ticker)this.animationFrameId&&this.stop(),this.playing||(this.playing=!0,this.ticker.add(this));else if(!this.animationFrameId){this.animationFrameId=window.requestAnimationFrame(function t(){e.animationFrameId=window.requestAnimationFrame(t),e.draw()})}}},{key:"stop",value:function(){this.animationFrameId&&(window.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.playing&&(this.playing=!1,this.ticker.remove(this))}},{key:"destroy",value:function(t){if(this.stop(),this.gl&&this.data&&e.destroy(this.gl,this.data),t){var i=this.dimensions||{};this._source=this._source||{type:this.type,media:this.media,width:i.width,height:i.height}}else this.config.target.removeEventListener("webglcontextlost",this._loseContext,!0),this.config=null,this.dimensions=null;this.gl=null,this.data=null,this.media=null,this.type=null}},{key:"restoreContext",value:function(){var e=this.config.target,t=this.config.target.cloneNode(!0),i=e.parentNode;i&&i.replaceChild(t,e),this.config.target=t,e.removeEventListener("webglcontextlost",this._loseContext,!0),e.removeEventListener("webglcontextrestored",this._restoreContext,!0),t.addEventListener("webglcontextlost",this._loseContext,!0),this.lostContext&&this._restoreContext()}},{key:"_createTextures",value:function(){var t=this;this.data&&this.data.textures.forEach(function(i,a){t.data.textures[a].texture=e.createTexture(t.gl,{width:t.dimensions.width,height:t.dimensions.height,format:i.format,data:i.image}).texture})}}]),t}(),Ticker:d}},"object"===d(t)&&void 0!==e?e.exports=o():void 0===(n="function"==typeof(a=o)?a.call(t,i,t,e):a)||(e.exports=n)},406:function(e,t,i){var a,n;a=[i(2),i(4),i(0),i(1),i(22),i(3)],void 0===(n=function(e,t,i,a,n,o){"use strict";function r(e){var t=e.imageOverlay,i=e.getMediaFullStaticUrl,o=e.currentUrl;if(t){var r={imageData:e.imageOverlay,containerWidth:e.imageOverlay.width,containerHeight:e.imageOverlay.height,displayMode:n.fittingTypes.TILE};return"url("+a.imageUtils.getImageComputedProperties(n,r,i,o,1,n.htmlTag.BG).uri+")"}return""}function s(e){var t=e.blendMode,i=e.mixBlendModeSupported,a=e.blendModeOpacity;return t?!i()&&"overlay"===t?a/2:a:1}function d(e){return{width:"100%",height:"100%",position:"absolute",top:0,backgroundImage:e.isExperimentOpen("sv_ssr_image_src")?r(e):"",opacity:s(e)}}return{displayName:"bgOverlay",mixins:[o.mixins.skinBasedComp],propTypes:{style:t.object,colorOverlay:t.string,colorOverlayOpacity:t.number,imageOverlay:t.object,bgEffectName:t.string,blendMode:t.string,blendModeOpacity:t.number,mixBlendModeSupported:e.santaTypesDefinitions.BrowserFlags.mixBlendModeSupported.isRequired,isExperimentOpen:e.santaTypesDefinitions.isExperimentOpen,colorsMap:e.santaTypesDefinitions.Theme.colorsMap.isRequired,fixedBackgroundColorBalata:e.santaTypesDefinitions.BrowserFlags.fixedBackgroundColorBalata.isRequired,renderFixedPositionBackgrounds:e.santaTypesDefinitions.RenderFlags.renderFixedPositionBackgrounds,currentUrl:e.santaTypesDefinitions.currentUrl,getMediaFullStaticUrl:e.santaTypesDefinitions.ServiceTopology.getMediaFullStaticUrl},componentDidLayout:function(){},getSkinProperties:function(){return e={"":{style:(u=this.props,c=u.colorOverlay?a.colorParser.getColor(u.colorsMap,u.colorOverlay,u.colorOverlayOpacity):"",h=u.blendMode||"",i.assign({position:"absolute",width:"100%",height:"100%",top:0},c&&{backgroundColor:c},h&&{mixBlendMode:h},u.style)),"data-background-image":r(this.props),"data-position":(o=this.props,s=o.bgEffectName,p=o.fixedBackgroundColorBalata,l=o.renderFixedPositionBackgrounds,p&&a.containerBackgroundUtils.isFullScreenByEffect(s,l)?"fixed":"absolute")}},t=a.mediaConsts.balataConsts.OVERLAY,n={style:d(this.props)},t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var e,t,n,o,s,p,l,u,c,h}}}.apply(t,a))||(e.exports=n)},407:function(e,t,i){var a,n;a=[i(408)],void 0===(n=function(e){"use strict";return e.getIframeVideoComponent({iframeUrl:"https://wix-private.github.io/video-fx-player/360.html",apiId:"wix-video-fx-player",displayName:"iframeVideo"})}.apply(t,a))||(e.exports=n)},408:function(e,t,i){var a,n;a=[i(0),i(4),i(3),i(1),i(45),i(2),i(174)],void 0===(n=function(e,t,i,a,n,o,r){"use strict";var s=a.mediaConsts;return{getIframeVideoComponent:function(d){var p=d.iframeUrl,l=d.apiId,u=d.displayName;return{displayName:void 0===u?"iframeVideo":u,mixins:[r,i.mixins.skinBasedComp,i.mixins.createChildComponentMixin],propTypes:e.defaults({compData:t.object.isRequired,compProp:t.object,isPlayingAllowed:t.bool,mediaQuality:t.string,notifyMediaState:t.func.isRequired,setMediaAPI:t.func.isRequired,staticVideoUrl:o.santaTypesDefinitions.ServiceTopology.staticVideoUrl},o.utils.santaTypesUtils.getSantaTypesFromPropTypes(o.components.Image.propTypes)),getInitialState:function(){return this.player=null,this.eventHandlers=[],{loadVideo:!1,showVideo:!1}},componentDidMount:function(){this.props.setMediaAPI(this.mediaAPI),this.props.notifyMediaState({type:s.eventTypes.MOUNT,playbackState:s.playbackTypes.LOADING}),this.props.compProp.autoplay&&this.props.isPlayingAllowed&&this.play()},componentDidUpdate:function(){this.setRate(this.props.compData.playbackSpeed||1)},componentWillUnmount:function(){this.props.setMediaAPI(null),this.removeVideoSecurely()},getUrl:function(t,i){var n="https://video.wixstatic.com/";if(!i)return"";var o=e.find(t.qualities,{quality:i});return o.url?a.urlUtils.joinURL(n,o.url):a.urlUtils.joinURL(n,t.videoId,i,"mp4","file.mp4")},onVideoFrameReady:function(){var e=this,t=this.getUrl(this.props.compData,this.props.mediaQuality);n.api.request(l,{target:this.refs.video}).then(function(i){e.player=i,e.player.set(t,{loop:!1,mute:e.props.compProp.mute||!1===e.props.compData.hasAudio,autoplay:!0,rate:e.props.compData.playbackSpeed||1,preload:e.props.compData.preload||"none"},e.onVideoEvent),e.addVideoEventListener("timeupdate",e.handlePosterVisibilityOnce),e.addVideoEventListener("ended",e.onPlayEnded),e.addVideoEventListener("error",e.onError),e.addVideoEventListener("loadstart",e.onLoadStart),e.addVideoEventListener("durationchange",e.onDurationChange),e.addVideoEventListener("pause",e.onPause),e.addVideoEventListener("play",e.onPlay),e.addVideoEventListener("progress",e.onProgress),e.addVideoEventListener("ratechange",e.onRateChange),e.addVideoEventListener("seeked",e.onSeekEnd),e.addVideoEventListener("seeking",e.onSeekStart),e.addVideoEventListener("stalled",e.onStalled),e.addVideoEventListener("timeupdate",e.onTimeUpdate),e.addVideoEventListener("volumechange",e.onVolumeChange)}).catch(function(e){console.log("Video API not loaded.",e)})},addVideoEventListener:function(t,i){if(!e.find(this.eventHandlers,{eventType:t,handler:i}))return this.eventHandlers.push({eventType:t,handler:i}),!0},removeVideoEventListener:function(t,i){if(e.find(this.eventHandlers,{eventType:t,handler:i}))return this.eventHandlers=e.reject(this.eventHandlers,{eventType:t,handler:i}),!0},onVideoEvent:function(t){var i=e.filter(this.eventHandlers,{eventType:t.type});e.forEach(i,function(e){e.handler(t)})},handlePosterVisibilityOnce:function(e){e.currentTime>0&&(this.removeVideoEventListener("timeupdate",this.handlePosterVisibilityOnce),this.setState({showVideo:!0}))},resetPosterState:function(){this.state.showVideo&&(this.setState({showVideo:!1}),this.addVideoEventListener("timeupdate",this.handlePosterVisibilityOnce))},removeVideoSecurely:function(){this.player&&(this.eventHandlers=[],this.player.reset())},play:function(){this.player?this.player.play():this.setState({loadVideo:!0})},pause:function(){this.player&&this.player.pause()},stop:function(){this.player&&(this.pause(),this.seek(0),this.resetPosterState())},setVolume:function(e){this.player&&this.player.setVolume(e)},mute:function(){this.player&&this.player.setMute(!0)},unMute:function(){this.player&&this.player.setMute(!1)},seek:function(e){this.player&&this.player.seek(e)},setRate:function(e){this.player&&this.player.setRate(e)},onLoadStart:function(e){this.props.notifyMediaState({type:s.eventTypes.LOAD,playbackState:s.playbackTypes.READY,volume:e.volume,muted:e.muted,looped:this.props.compProp.loop,currentTime:e.currentTime,progress:0})},onDurationChange:function(e){this.props.notifyMediaState({type:s.eventTypes.LOAD,duration:e.duration})},onTimeUpdate:function(e){this.props.notifyMediaState({type:s.eventTypes.TIME_UPDATE,currentTime:e.currentTime})},onPlayEnded:function(){this.props.notifyMediaState({type:s.eventTypes.PLAYSTATE,playbackState:s.playbackTypes.PLAY_ENDED})},onPlay:function(){this.props.notifyMediaState({type:s.eventTypes.PLAYSTATE,playbackState:s.playbackTypes.PLAYING})},onPause:function(){this.props.notifyMediaState({type:s.eventTypes.PLAYSTATE,playbackState:s.playbackTypes.PAUSED})},onError:function(e){e.networkState===e.NETWORK_NO_SOURCE?this.props.notifyMediaState({type:s.eventTypes.ERROR,error:s.errorTypes.NO_VIDEO_FOUND}):this.props.notifyMediaState({type:s.eventTypes.ERROR,error:s.errorTypes.VIDEO_GENERAL_ERROR})},onStalled:function(e){e.readyState===e.HAVE_NOTHING&&this.props.notifyMediaState({type:s.eventTypes.ERROR,error:s.errorTypes.NO_VIDEO_FOUND})},onProgress:function(e){this.props.notifyMediaState({type:s.eventTypes.PROGRESS,progress:e.progress})},onSeekStart:function(){this.props.notifyMediaState({type:s.eventTypes.PLAYSTATE,playbackState:s.playbackTypes.SEEKING})},onSeekEnd:function(){this.props.notifyMediaState({type:s.eventTypes.PLAYSTATE,playbackState:s.playbackTypes.SEEKING_ENDED})},onVolumeChange:function(e){this.props.notifyMediaState({type:s.eventTypes.VOLUME,volume:e.volume,muted:e.muted})},onRateChange:function(e){this.props.notifyMediaState({type:s.eventTypes.RATE,playbackRate:e.playbackRate})},getVideo:function(){return o.utils.createReactElement("iframe",{ref:"video",id:this.props.id+"video",frameBorder:0,allowFullScreen:!0,"data-src":this.state.loadVideo?p:"about:blank",onLoad:this.onVideoFrameReady})},getSkinProperties:function(){var e={containerWidth:this.props.posterWidth||0,containerHeight:this.props.posterHeight||0,shouldRenderSrc:this.props.shouldRenderSrc},t=this.getPosterImageComp(this.props.compData.posterImageRef,this.state.showVideo,e);return{"":{"data-quality":this.props.mediaQuality,"data-player-type":"iframe",style:{width:"100%"}},video:this.getVideo(),poster:t}}}}}}.apply(t,a))||(e.exports=n)},409:function(e,t,i){var a;void 0===(a=function(){"use strict";var e={"skins.viewer.bgImage.bgImageSkin":{react:[],css:{}},"skins.viewer.bgMedia.bgMediaSkin":{react:[],css:{}},"skins.viewer.bgOverlay.bgOverlaySkin":{react:[["div","overlay",[],{}]]},"skins.viewer.bgVideo.html5VideoSkin":{react:[["video","video",[],{role:"presentation"}],["div","poster",[],{}]],exports:{poster:{skin:"skins.core.ImageNewSkinZoomable"}},css:{}},"skins.viewer.bgVideo.iframeVideoSkin":{react:[["div","video",[],{}],["div","poster",[],{}]],exports:{poster:{skin:"skins.core.ImageNewSkinZoomable"}},css:{}},"skins.viewer.bgVideo.webglMediaSkin":{react:[["canvas","canvas",[],{}]],css:{}}};return e}.apply(t,[]))||(e.exports=a)},45:function(e,t){e.exports=p},5:function(e,t){e.exports=o},9:function(e,t){e.exports=r}})});
//# sourceMappingURL=backgroundCommon.min.js.map